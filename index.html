<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roulette Gourmande</title>

<style>
:root{
  --brown:#8b4513;
  --dark:#6f3b12;
  --cream:#fffaf4;
  --accent:#c46a2b;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:#f2f2f2;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
}

.container{
  max-width:420px;
  margin:30px auto;
  background:var(--cream);
  border-radius:28px;
  padding:26px 20px 32px;
  text-align:center;
  box-shadow:0 25px 45px rgba(0,0,0,.15);
}

h1{
  color:var(--brown);
  margin:0 0 6px;
}

.subtitle{
  color:#666;
  margin-bottom:20px;
}

.alert{
  background:#fff3e6;
  border:1px solid #ffd3a8;
  color:#8a4b12;
  padding:14px;
  border-radius:14px;
  font-size:14px;
  margin-bottom:24px;
}

.wheel-wrapper{
  position:relative;
  width:300px;
  height:300px;
  margin:0 auto 26px;
}

canvas{
  width:300px;
  height:300px;
}

.pointer{
  position:absolute;
  top:-12px;
  left:50%;
  transform:translateX(-50%);
  width:0;
  height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:26px solid var(--accent);
}

button{
  width:100%;
  padding:16px;
  font-size:17px;
  font-weight:600;
  border:none;
  border-radius:18px;
  background:linear-gradient(180deg,var(--brown),var(--dark));
  color:white;
  cursor:pointer;
}

button:disabled{
  opacity:.6;
  cursor:not-allowed;
}

.footer{
  margin-top:14px;
  font-size:13px;
  color:#777;
}
</style>
</head>

<body>

<div class="container">
  <h1>Roulette Gourmande</h1>
  <div class="subtitle">Bonne chance üéÅ</div>

  <div class="alert">
    ‚ö†Ô∏è Pour r√©cup√©rer votre gain, une preuve de l‚Äôavis Google sera demand√©e
    (capture √©cran ou email).
  </div>

  <div class="wheel-wrapper">
    <div class="pointer"></div>
    <canvas id="wheel"></canvas>
  </div>

  <button id="spinBtn">üé∞ Tourner la roulette</button>

  <div class="footer">Jeu valable une seule fois par client.</div>
</div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const spinBtn = document.getElementById("spinBtn");

const prizes = [
  "üéü Prochaine visite",
  "üç∞ Dessert maison",
  "‚òï Caf√© ou th√©",
  "üçü Portion offerte",
  "üòÖ Rien cette fois"
];

const colors = ["#a85d1a","#8b4513","#c46a2b","#7a3e12","#6f737d"];

const size = 300;
const dpr = window.devicePixelRatio || 1;

// Canvas HD Retina
canvas.width = size * 2 * dpr;
canvas.height = size * 2 * dpr;
ctx.scale(dpr, dpr);
ctx.translate(size, size);

let angle = 0;
let spinning = false;

function drawWheel(){
  const slice = (2 * Math.PI) / prizes.length;
  ctx.clearRect(-size, -size, size*2, size*2);

  prizes.forEach((text, i) => {
    ctx.beginPath();
    ctx.fillStyle = colors[i];
    ctx.moveTo(0,0);
    ctx.arc(0,0,size, angle + i*slice, angle + (i+1)*slice);
    ctx.fill();

    ctx.save();
    ctx.rotate(angle + (i + 0.5) * slice);
    ctx.fillStyle = "#fff";
    ctx.font = "bold 16px -apple-system, BlinkMacSystemFont, sans-serif";
    ctx.textAlign = "right";
    ctx.fillText(text, size - 18, 6);
    ctx.restore();
  });
}

drawWheel();

spinBtn.addEventListener("click", () => {
  if(spinning) return;
  spinning = true;
  spinBtn.disabled = true;

  const startAngle = angle;
  const extraSpins = Math.PI * 8;
  const randomOffset = Math.random() * Math.PI * 2;
  const targetAngle = startAngle + extraSpins + randomOffset;

  const duration = 3500;
  const startTime = performance.now();

  function animate(time){
    const progress = Math.min((time - startTime) / duration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);

    angle = startAngle + (targetAngle - startAngle) * ease;
    drawWheel();

    if(progress < 1){
      requestAnimationFrame(animate);
    } else {
      spinning = false;
      spinBtn.disabled = false;
    }
  }

  requestAnimationFrame(animate);
});
</script>

</body>
</html>
