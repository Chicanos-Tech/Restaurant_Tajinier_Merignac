<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tajinier ‚Ä¢ Avis & Roulette</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --gold:#c8a45b;
  --dark:#0f172a;
  --glass:rgba(255,255,255,0.12);
  --neon-blue:#00d4ff;
  --silver:#c0c0c0;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:radial-gradient(circle at top,#1e293b,#020617);
  font-family:'Inter',sans-serif;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.container{
  width:420px;
  background:linear-gradient(145deg,rgba(255,255,255,0.08),rgba(255,255,255,0.02));
  backdrop-filter:blur(25px);
  border-radius:32px;
  padding:30px 24px 36px;
  text-align:center;
  box-shadow:
    0 30px 60px rgba(0,0,0,.6),
    inset 0 1px 0 rgba(255,255,255,.15);
  border:1px solid rgba(255,255,255,0.12);
}

h1{
  margin:0;
  font-size:28px;
  font-weight:700;
  background:linear-gradient(135deg,#fff,var(--neon-blue));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.subtitle{
  color:#94a3b8;
  margin:8px 0 24px;
  font-size:15px;
}

input{
  width:100%;
  padding:14px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.06);
  color:white;
  font-size:15px;
  margin-bottom:16px;
  outline:none;
}

input::placeholder{color:#94a3b8}

button{
  width:100%;
  padding:16px;
  border:none;
  border-radius:18px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  transition:.25s;
  background:linear-gradient(135deg,var(--silver),var(--neon-blue));
  color:black;
  box-shadow:0 10px 30px rgba(0,212,255,.35);
  text-shadow:0 1px 2px rgba(0,0,0,.3);
}

button:hover{
  transform:translateY(-2px);
  box-shadow:0 15px 40px rgba(0,212,255,.55);
}

.gain-display{
  margin:12px 0 24px;
  padding:20px;
  border-radius:24px;
  background:linear-gradient(135deg,rgba(0,212,255,.15),rgba(192,192,192,.1));
  border:1px solid rgba(0,212,255,.3);
  font-size:24px;
  font-weight:700;
  color:var(--neon-blue);
  text-shadow:0 0 10px rgba(0,212,255,.5);
}

.alert{
  margin:18px 0;
  margin-bottom:45px;
  padding:14px;
  border-radius:16px;
  background:rgba(200,164,91,.12);
  border:1px solid rgba(200,164,91,.35);
  font-size:14px;
  color:#fcd34d;
}

.wheel-wrapper{
  position:relative;
  width:320px;
  height:360px;
  margin:12px auto 26px;
  display:flex;
  flex-direction:column;
  align-items:center;
}

.wheel-container{
  position:relative;
  width:320px;
  height:320px;
  border-radius:50%;
  background:radial-gradient(circle,rgba(30,41,59,.8),#020617);
  box-shadow:
    inset 0 0 60px rgba(0,0,0,.9),
    0 0 40px rgba(0,212,255,.3),
    0 0 80px rgba(192,192,192,.1);
  backdrop-filter:blur(10px);
}

canvas{
  width:320px !important;
  height:320px !important;
  border-radius:50%;
  filter:drop-shadow(0 0 20px rgba(0,212,255,.4));
}

.pointer{
  width:30px;
  height:40px;
  position:relative;
  margin-bottom:5px;
}

.pointer::before{
  content:'';
  position:absolute;
  left:50%;
  bottom:0;
  transform:translateX(-50%);
  width:0;
  height:0;
  border-left:15px solid transparent;
  border-right:15px solid transparent;
  border-top:30px solid var(--neon-blue);
  filter:drop-shadow(0 0 12px rgba(0,212,255,1)) drop-shadow(0 4px 8px rgba(0,0,0,.8));
}

.hidden{display:none}

.footer{
  margin-top:10px;
  font-size:13px;
  color:#64748b;
}
</style>
</head>

<body>

<div class="container">

  <!-- PAGE AVIS -->
  <div id="avisPage">
    <h1>Tajinier ‚ú®</h1>
    <div class="subtitle">Merci pour votre visite</div>

    <input type="email" placeholder="Votre email">

    <button id="reviewBtn">‚≠ê Laisser un avis Google</button>

    <div class="alert">
      Apr√®s publication de votre avis,<br>
      revenez tourner la roulette üéÅ
    </div>

    <button id="goRoulette">üé∞ Acc√©der √† la roulette</button>
  </div>

  <!-- PAGE ROULETTE -->
  <div id="roulettePage" class="hidden">
    <h1>Roulette Gourmande</h1>
    <div class="subtitle">Bonne chance üçÄ</div>

    <div class="gain-display" id="gainDisplay" style="display:none;">
      F√âLICITATIONS !<br>Gain : <span id="prizeWon"></span>
    </div>

    <div class="alert">
      ‚ö†Ô∏è Une preuve de l'avis Google sera demand√©e
    </div>

    <div class="wheel-wrapper">
      <div class="pointer"></div>
      <div class="wheel-container">
        <canvas id="wheel"></canvas>
      </div>
    </div>

    <button id="spinBtn">üé∞ Tourner la roulette</button>

    <div class="footer">Jeu valable une seule fois</div>
  </div>

</div>

<script>
const reviewBtn = document.getElementById("reviewBtn");
const goRoulette = document.getElementById("goRoulette");
const avisPage = document.getElementById("avisPage");
const roulettePage = document.getElementById("roulettePage");

reviewBtn.addEventListener("click",()=>{
  window.open("https://search.google.com/local/writereview?placeid=ChIJ5yphIvDZVA0Rykpm0HohmHA","_blank");
});

goRoulette.addEventListener("click",()=>{
  avisPage.classList.add("hidden");
  roulettePage.classList.remove("hidden");
});

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");

const prizes = [
  "Repas gratuit",
  "Boisson off", 
  "Dessert cadeau",
  "50‚Ç¨ cash",
  "Menu duo",
  "Voucher 20‚Ç¨"
];

const colors = [
  "rgba(200,164,91,.9)",
  "rgba(139,94,52,.9)", 
  "rgba(212,175,55,.9)",
  "rgba(161,124,58,.9)",
  "rgba(71,85,105,.9)",
  "rgba(0,212,255,.9)"
];

const size = 155;
canvas.width = 320;
canvas.height = 320;
ctx.translate(160,160);

let angle = 0;
let spinning = false;
let currentPrize = "";

// La roulette commence avec le segment 0 en HAUT
const startOffset = Math.PI / 2; // 90¬∞ pour avoir segment 0 en haut au d√©part

function drawWheel(){
  const slice = (2*Math.PI)/prizes.length;
  ctx.clearRect(-160,-160,320,320);

  ctx.beginPath();
  ctx.arc(0,0,size+8,0,2*Math.PI);
  ctx.strokeStyle = "rgba(0,212,255,.3)";
  ctx.lineWidth = 4;
  ctx.shadowColor = "rgba(0,212,255,.6)";
  ctx.shadowBlur = 20;
  ctx.stroke();
  ctx.shadowBlur = 0;

  prizes.forEach((text,i)=>{
    // On dessine depuis le haut (startOffset) pour que segment 0 soit en haut
    const startAngle = startOffset + angle + i*slice;
    const endAngle = startOffset + angle + (i+1)*slice;
    
    const gradient = ctx.createRadialGradient(0,0,0,0,0,size);
    gradient.addColorStop(0, colors[i]);
    gradient.addColorStop(1, colors[i].replace('.9','.4'));
    
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0,size,startAngle,endAngle);
    ctx.fillStyle = gradient;
    ctx.fill();

    ctx.shadowColor = colors[i].replace('.9','1');
    ctx.shadowBlur = 15;
    ctx.fill();
    ctx.shadowBlur = 0;

    ctx.save();
    ctx.rotate(startAngle + slice/2);
    ctx.fillStyle = "rgba(255,255,255,0.95)";
    ctx.strokeStyle = "rgba(0,212,255,0.8)";
    ctx.lineWidth = 1;
    ctx.font = "bold 14px Inter";
    ctx.textAlign = "right";
    ctx.textBaseline = "middle";
    ctx.shadowColor = "rgba(0,212,255,0.8)";
    ctx.shadowBlur = 8;
    ctx.strokeText(text, size-20, 0);
    ctx.shadowBlur = 4;
    ctx.fillText(text, size-20, 0);
    ctx.restore();
  });
}

drawWheel();

document.getElementById("spinBtn").addEventListener("click",()=>{
  if(spinning) return;
  spinning = true;

  const spins = 8 + Math.random()*3;
  const randomSlice = Math.floor(Math.random() * prizes.length);
  const targetAngle = -(Math.PI*2 * spins + (Math.PI*2 / prizes.length) * randomSlice);
  
  const duration = 4500 + Math.random()*500;
  const startTime = performance.now();
  const startAngle = angle;

  function animate(time){
    const elapsed = time - startTime;
    const progress = Math.min(elapsed / duration, 1);
    
    const ease = 1 - Math.pow(1 - progress, 3);
    
    angle = startAngle + (targetAngle - startAngle) * ease;
    drawWheel();

    if(progress < 1){
      requestAnimationFrame(animate);
    } else {
      spinning = false;
      
      // M√âTHODE SIMPLE : on calcule quel segment est en haut apr√®s rotation
      const slice = (2*Math.PI) / prizes.length;
      
      // Normaliser l'angle entre 0 et 2*PI
      let normalizedAngle = angle % (2*Math.PI);
      if(normalizedAngle < 0) normalizedAngle += 2*Math.PI;
      
      // Calculer l'index (on tourne dans le sens n√©gatif)
      let sliceIndex = Math.floor((2*Math.PI - normalizedAngle) / slice) % prizes.length;
      
      currentPrize = prizes[sliceIndex];
      
      console.log("Angle final:", angle, "Normalis√©:", normalizedAngle, "Index:", sliceIndex, "Prix:", currentPrize);
      
      document.getElementById("prizeWon").textContent = currentPrize;
      document.getElementById("gainDisplay").style.display = "block";
      
      document.getElementById("spinBtn").textContent = "üéâ D√©j√† tourn√© !";
      document.getElementById("spinBtn").disabled = true;
    }
  }

  requestAnimationFrame(animate);
});
</script>

</body>
</html>
